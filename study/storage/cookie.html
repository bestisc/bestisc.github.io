<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <script>
        //document.cookie = "name=12456;max-age="+(8*60*60+60);+";path=./study;domain=127.0.0.1;secure=true";

        setCookie({
            key:"name1",
            value:"156#$@$#%^43215",
            failureTime:100,
        });
        setCookie({
            key:"key",
            value:"156432#$@%#%^$15",
            failureTime:100,
        });
        setCookie({
            key:"www",
            value:"1#%#$5643215",
            failureTime:100,
        });
        setCookie({
            key:"xyz",
            value:"156#%$#^43215",
            failureTime:100,
        });
        setCookie({
            key:"qwsdf",
            value:"15643#%$%^%&%&*&(*)+215",
            failureTime:100,
        });
        setCookie({
            key:"dsfegrdg",
            value:"156#$@#$%$#^%#@%^43215",
            failureTime:100,
        });
        //setCookie("name2","23dfse4",1);
        //setCookie("name3","45dfsdf6",1);
        
        //  设置cookie
        function setCookie({
            key:key,
            value:value,
            failureTime:failureTime
        }){
            //使用window.encodeURIComponent()方法对value值进行编码，来转义分号、逗号和空白符
            var cookie = key + "=" + window.encodeURIComponent(value);	
            
            //设置cookie失效时间 单位为分钟
            if(typeof failureTime === "number"){
                cookie += "; max-age=" + (failureTime * 60 + 8 * 60 * 60);
            }
        
            //将cookie存储到浏览器
            document.cookie = cookie;
        }

        //path = path;domain = domain;secure


        // 以名/值的形式存储cookie
        // 同时采用encodeURIComponent()函数进行编码，来转义分号、逗号和空白符
        // 如果daysToLive是一个数字, 设置max-age属性为该数值表示cookie直到指定的天数
        // 到了才会过期。如果daysToLive是0就表示删除cookie
        function set_cookie(name, value, daysToLive){    
            var cookie = name + "=" + encodeURIComponent(value);
            if (typeof daysToLive === "number")        
            cookie += "; max-age=" + (daysToLive * 60 * 60 * 24);    
            document.cookie = cookie;
        }
    </script>

    <script>
        // 将document.cookie的值以名/值对组成的一个对象返回
        // 假设存储cookie的值的时候是采用encodeURIComponent()函数编码的
        function getcookie() {    
            var cookie = {}; // 初始化最后要返回的对象    
            var all = document.cookie; 
            // 在一个大写字符串中获取所有的cookie值    
            if (all === "") // 如果该cookie属性值为空字符串        
            return cookie; // 返回一个空对象    
            var list = all.split("; "); // 分离出名/值对    
            for (var i = 0; i < list.length; i++) { // 遍历每个cookie
                var cookie = list[i];        
                var p = cookie.indexOf("="); // 查找第一个"="符号        
                var name = cookie.substring(0, p); // 获取cookie名字        
                var value = cookie.substring(p + 1); // 获取cookie对应的值        
                value = decodeURIComponent(value); // 对其值进行解码        
                cookie[name] = value; // 将名/值对存储到对象中    
            }    
            return cookie;
        }
    </script>

    <script>
        //实现基于cookie的存储API
        /* * cookieStorage.js * 本类实现像localStorage和sessionStorage一样的存储API，不同的是，基于HTTP cookie实现它 */
        function cookieStorage(maxage, path) { 
            // 两个参数分别代表存储有效期和作用域 

            // 获取一个存储全部cookie信息的对象    
            var cookie = (function() { // 类似之前介绍的getcookie()函数        
                var cookie = {}; // 该对象最终会返回        
                var all = document.cookie; // 以大字符串的形式获取所有cookie信息        
                if (all === "") // 如果该属性为空字符串
        
                return cookie; //返回一个空对象        
                var list = all.split("; "); // 分离出名/值对        
                for (var i = 0; i < list.length; i++) { 
                    // 遍历每个cookie            
                    var cookie = list[i];            
                    var p = cookie.indexOf("="); // 查找第一个"="符号            
                    var name = cookie.substring(0, p); // 获取cookie名字            
                    var value = cookie.substring(p + 1); // 获取cookie对应的值            
                    value = decodeURIComponent(value); // 对其值进行解码            
                    cookie[name] = value; // 将名值对存储到对象中        
                }        
                return cookie;    
            }());    

            // 将所有cookie的名字存储到一个数组中    
            var keys = [];    
            for (var key in cookie) keys.push(key);

            // 现在定义存储API公共的属性和方法  
              
            // 存储的cookie的个数    
            this.length = keys.length;    
            // 返回第n个cookie的名字, 如果n越界则返回null    
            this.key = function(n) {        
                if (n < 0 || n >= keys.length) return null;
        
                return keys[n];    
            };    
            // 返回指定名字的cookie值, 如果不存在则返回null.

            this.getItem = function(name) {        
                return cookie[name] || null;    
            };    // 存储cookie值   
             
            this.setItem = function(key, value) {        
                if (!(key in cookie)) { 
                    // 如果要存储的cookie还不存在            
                    keys.push(key); // 将指定的名字加入到存储所有cookie名的数组中            
                    this.length++; // cookie个数加一        
                }        // 将该名/值对数据存储到cookie对象中        
                cookie[key] = value;        // 开始正式设置cookie        
                // 首先将要存储的cookie的值进行编码，同时创建一个"名字=编码后的值"形式的字符串        
                var cookie = key + "=" + encodeURIComponent(value);        
                //将cookie的属性也加入到该字符串中        
                if (maxage) cookie += "; max-age=" + maxage;        
                if (path) cookie += "; path=" + path;

                // 通过document.cookie属性来设置cookie        
                document.cookie = cookie;    
            }; 
               
            // 删除指定的cookie    
            this.removeItem = function(key) {        
                if (!(key in cookie)) return; 
                // 如果cookie不存在，则什么也不做        
                // 从内部维护的cookie组删除指定的cookie        
                delete cookie[key];        
                // 同时将cookie中的名字也在内部的数组中删除        
                // 如果使用ES5定义的数组 indexOf()方法会更加简单        
                for (var i = 0; i < keys.length; i++) { // 遍历所有的名字            
                    if (keys[i] === key) { // 当我们找到了要找的那个                
                        keys.splice(i, 1); // 将它从数组中删除                
                        break;            
                    }        
                }        
                this.length--; // cookie个数减一        
                // 最终通过将该cookie值设置为空字符串以及将有效期设置为0来删除指定的cookie        
                document.cookie = key + "=; max-age=0";    
            };

            // 删除所有的cookie    
            this.clear = function() {        
                // 循环所有的cookie的名字，并将cookie删除        
                for (var i = 0; i < keys.length; i++)            
                document.cookie = keys[i] + "=; max-age=0";        
                // 重置所有的内部状态        
                cookie = {};        
                keys = [];        
                this.length = 0;    
            };
        }
    </script>
</body>
</html>